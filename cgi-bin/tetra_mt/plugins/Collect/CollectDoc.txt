<li><a href="#Collect">About the Collect Plugin</a></li>
<li><a href="#MTCollect">MTCollect</a></li>
<li><a href="#MTCollectThis">MTCollectThis</a></li>
<li><a href="#MTIfCollected">MTIfCollected</a></li>
<li><a href="#MTCollected">MTCollected</a></li>
<li><a href="#MTCollectedEntryTags">MTCollectedEntryTags</a></li>
<li><a href="#MTCollectedTag">MTCollectedTag</a></li>
<li><a href="#MTCollectedContent">MTCollectedContent</a></li>
<li><a href="#MTCollectedSite">MTCollectedSite</a></li>
<li><a href="#MTCollectedAttr">MTCollectedAttr</a></li>
<li><a href="#MTIfCollectedContent">MTIfCollectedContent</a></li>
<li><a href="#MTIfCollectedSite">MTIfCollectedSite</a></li>
<li><a href="#MTIfCollectedAttr">MTIfCollectedAttr</a></li>
<li><a href="#MTCollectedGroup">MTCollectedGroup</a></li>
<li><a href="#MTCollectedTotalCount">MTCollectedTotalCount</a></li>
<li><a href="#MTCollectedGroupCount">MTCollectedGroupCount</a></li>
<li><a href="#MTCollectedIndex">MTCollectedIndex</a></li>
<li><a href="#MTCollectedArchive">MTCollectedArchive</a></li>
<li><a href="#UsageExamples">Usage Examples</a></li>
<li><a href="#VersionHistory">Version History</a></li>
</ul>

<h2><a name="Collect"></a>About the Collect Plugin</h2>
<p>This <a href="http://www.sixapart.com/movabletype/">Movable Type</a> plugin implements a set of <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#template%20tags">template tags</a> for collecting information from specified HTML tags in your entries, and collating and displaying that information. This lets you enhance your MT-based pages in a variety of ways. For example, you could:</p>
<ul>
<li>Display footnotes for the links or images that appear within each entry. The <a href="StripTagsReadMe.html">StripTags plugin</a> could also do this; since this plugin can do everything StripTags can do and much more, StripTags is superseded by Collect and will no longer be updated. See the <a href="#UsageExamples">Usage Examples</a> section, below, for some examples of how to duplicate the functionality of StripTags with Collect.</li>
<li>Generate a "Recent Links" listing to display in your sidebar.</li>
<li>Create "by citation" or "by quotation" archives, similar to the ones Mark Pilgrim has on <a href="http://diveintomark.org/archives/citations/">his</a> <a href="http://diveintomark.org/archives/quotations/">site</a>. (Of course, this requires that your entries have the appropriate semantic markup.)</li>
<li>For a photography weblog, make an index page showing thumbnails for all images that have appeared in your entries (assuming you have thumbnail versions and they're named consistently).</li>
<li>Build a glossary of terms you've marked up with definitions using the <code>acronym</code> tag.
</ul>
<p>Since some of the examples of using the plugin are a bit involved, most of the working example code is deferred until the <a href="#UsageExamples">Usage Examples</a> section toward the end of this document. Before reading the  documentation for the individual tags, you might want to glance over some of the examples to get an overview of how it all works.</p>
<p>Please note that the Collect plugin does not do any validation of your HTML syntax. In fact, it gathers tags in a fairly simplistic way, so that if you have improperly nested tags within your entries, you'll probably get unexpected results. Also, the tags and attributes you tell the plugin to collect don't have to be legitimate HTML tags and attributes, but it's probably not advisable to take advantage of this fact to use non-standard tags or attributes, or put attributes into tags that aren't supposed to take them.</p>
<p>Thanks to <a href="http://www.nonplus.net/software/mt/">Stepan Riha</a> for testing and suggestions, and to <a href="http://diveintomark.org/">Mark Pilgrim</a> for the "Posts by Citation/Quotation" idea.</p>
<p><strong>Installation</strong></p>
<p>To install the Collect plugin, upload the file <I>Collect.pl</I> to the <i>plugins</i> directory within your Movable Type directory. If you do not already have a <i>plugins</i> directory, create one before uploading the file. For more information about Movable Type plugins, see the <A HREF="http://www.sixapart.com/movabletype/docs/mtmanual_programmatic.html#plugins">documentation</A>.</p>

<?php include '/home/staggernation/staggernation.com/mtplugins/support.inc'; ?>

<p>
<h2><a name="MTCollect"></a>MTCollect</h2></p>
<p>This container tag tells the plugin to collect data from specified HTML tag(s). All other tags defined by the Collect plugin must be used within <a href="#MTCollect"><code>MTCollect</code></a>. An <a href="#MTCollect"><code>MTCollect</code></a> container should surround an entire collection operation, both the "input" portion (the entry text from which you collect information using <a href="#MTCollectThis"><code>MTCollectThis</code></a>) and the "output" portion (in which you list the collected information using <a href="#MTCollected"><code>MTCollected</code></a> and related tags). In other words, while you can have multiple <a href="#MTCollect"><code>MTCollect</code></a> tags in one template, the information gathered by one instance of <a href="#MTCollect"><code>MTCollect</code></a> cannot be accessed from within another instance.</p>
<p>If you're collecting tags from multiple entries and combining them into a single listing, <a href="#MTCollect"><code>MTCollect</code></a> should go around <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#item_MTEntries"><code>MTEntries</code></a>. But if you're collecting tags entry-by-entry (for example, to show footnotes for each entry), <a href="#MTCollect"><code>MTCollect</code></a> should go within <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#item_MTEntries"><code>MTEntries</code></a>.</p>
<p>The tag takes the following attributes:</p>
<ul>
<li><strong>tags="tag1,tag2.." (required)</strong><br>
The names of one or more HTML tags you want to collect. Multiple tags should be separated by commas.</li>
<li><strong>urls="attr_name1,attr_name2,content.." (optional)</strong><br>
If you're going to use the <a href="#MTCollected"><code>MTCollected</code></a> tag with the <code>group_by="site"</code> option, described below, to display collected tag information summarized by site, you need to tell the plugin in advance which tag attribute(s) will contain URLs, so it knows where to find the site corresponding to each tag instance. To indicate this, pass one or more tag attribute names, separated by commmas, in <code>urls</code>. Pass <code>content</code> to indicate that the content of the collected tags (the text between the opening and closing tag) will be a URL.</li>
</ul>
<p>The following example tells the plugin you're going to collect <code>blockquote</code> tags, and the <code>cite</code> attribute of each tag instance will contain a URL:
<pre>&lt;MTCollect tags="blockquote" urls="cite"&gt;
...
&lt;/MTCollect&gt;
</pre>
<p>
<h2><a name="MTCollectThis"></a>MTCollectThis</h2></p>
<p>This container tag should surround the text from which you want to collect tags. <a href="#MTCollectThis"><code>MTCollectThis</code></a> should go within <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#item_MTEntries"><code>MTEntries</code></a>, even if <a href="#MTCollect"><code>MTCollect</code></a> is outside <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#item_MTEntries"><code>MTEntries</code></a>. You're not limited to collecting from the entry body; you can place any other MT template tags within <a href="#MTCollectThis"><code>MTCollectThis</code></a>. The following example collects tags from the entry body and extended entry:</p>
<pre>&lt;MTEntries&gt;
 &lt;MTCollectThis&gt;
  &lt;$MTEntryBody$&gt;
  &lt;$MTEntryMore$&gt;
 &lt;/MTCollectThis&gt;
&lt;/MTEntries&gt;
</pre>
<p>The tag takes the following attributes:</p>
<ul>
<li><strong>show="1" (optional)</strong><br>
By default, <a href="#MTCollectThis"><code>MTCollectThis</code></a> collects tags from the text within it, but does not display its contents. Pass the <code>show</code> attribute if you do want to display the tag's contents.
<li><strong>[tagname]="format" (optional)</strong><br>
If you're collecting tags for purposes of footnoting, you may want to insert text before and/or after the tagged text. Other than <code>show</code>, every attribute you pass to <a href="#MTCollectThis"><code>MTCollectThis</code></a> will be treated as a tag name, indicating that the text specified in the <code>format</code> string should be inserted next to each instance of that tag.</p>
<p>The <code>format</code> string can have two parts, separated by a slash: whatever comes before the slash will be inserted before each instance of <code>&lt;tagname&gt;</code>, and whatever comes after the slash will be inserted after each instance of <code>&lt;/tagname&gt;</code>, if applicable. HTML entities within the formatting strings will be decoded, so you can include HTML tags by using <code>&amp;lt;</code> and <code>&amp;gt;</code> in place of angle brackets. If you want to include a literal slash within one of the parts of the formatting string, you can either escape it with a backslash (<code>\/</code>) or use the HTML code <code>&amp;#47;</code>. </p>
<p>By using <a href="#MTCollectThis"><code>MTCollectThis</code></a> with MT's standard <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#global%20tag%20attributes"><code>remove_html</code></a> global attribute, you can duplicate the functionality of the StripTags plugin. Some examples of this are in the <a href="#UsageExamples">Usage Examples</a> section below.</p>
<p>Within <code>format</code>, <code>[N]</code> will output the number of the tag instance. The name of any tag attribute (non-case-sensitive) in square brackets will be replaced with that attribute, if it appears in that instance of the tag. To include literal square brackets in the <code>format</code> string, escape them with a backslash. The following example will replace each image with a string containing the image's path or URL:
<pre>&lt;MTCollectThis img="\[IMAGE: [src]\]" show="1" remove_html="1"&gt;
 &lt;$MTEntryBody$&gt;
&lt;/MTCollectThis&gt;
</pre>
</ul>
<p>
<h2><a name="MTIfCollected"></a>MTIfCollected</h2></p>
<p>This container tag displays its contents if and only if at least one instance of <strong>any</strong> of the specified tags was collected by <a href="#MTCollectThis"><code>MTCollectThis</code></a>. Otherwise, it displays nothing.</p>
<p>The tag takes the following attribute:</p>
<ul>
<li><strong>tags="tag1,tag2.." (optional)</strong><br>
The names of one or more HTML tags that must have been collected for MTIfCollected to display its contents. Multiple tags should be separated by commas. If you don't pass <code>tags</code>, <a href="#MTIfCollected"><code>MTIfCollected</code></a> will check for all the tags you originally told <a href="#MTCollect"><code>MTCollect</code></a> to collect.
<li><strong>show_local="1" (optional)</strong><br>
By default, if you pass a <code>urls</code> value to <a href="#MTCollect"><code>MTCollect</code></a>, <a href="#MTIfCollected"><code>MTIfCollected</code></a> will ignore tag instances with a blank site value&#151;in other words, relative links to pages or images on your own site. Pass this attribute if you want <a href="#MTIfCollected"><code>MTIfCollected</code></a> to take tags with no site into account.
</ul>
<p>
<h2><a name="MTCollected"></a>MTCollected</h2></p>
<p>This container tag loops through the tags that were collected by <a href="#MTCollectThis"><code>MTCollectThis</code></a>. Within <a href="#MTCollected"><code>MTCollected</code></a>, the other MTCollected* tags can be used to display various pieces of the collected tag information.</p>
<p><a href="#MTCollected"><code>MTCollected</code></a> can produce two basic types of listings: <strong>grouped</strong> and <strong>non-grouped</strong>. If the <code>group_by</code> attribute is not passed, <a href="#MTCollected"><code>MTCollected</code></a> simply loops through the collected tags, displaying its contents once for each tag instance that was collected. If the <code>group_by</code> attribute is passed, <a href="#MTCollected"><code>MTCollected</code></a> collates the tags into groupings according to the passed value, and displays its contents once for each grouping.</p>
<p>You can place an <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#item_MTEntries"><code>MTEntries</code></a> tag within a grouped <a href="#MTCollected"><code>MTCollected</code></a> listing, or within a template that's loaded by <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a>. For each grouping displayed, <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#item_MTEntries"><code>MTEntries</code></a> will list all the entries that contain tag instances that are part of that grouping. If you want to list the individual tag instances that are part of each entry, use <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a> within <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#item_MTEntries"><code>MTEntries</code></a>.</p>
<p>The tag takes the following attributes:</p>
<ul>
<li><strong>tags="tag1,tag2.." (optional)</strong><br>
The names of one or more HTML tags you want to display. Multiple tags should be separated by commas. If you don't pass <code>tags</code>, <a href="#MTCollected"><code>MTCollected</code></a> will list all the tags you originally told <a href="#MTCollect"><code>MTCollect</code></a> to collect. Note that you can collect multiple tags with a single </code></a>MTCollect</code></a>, then list them separately by using MTCollected more than once:
<pre>&lt;MTCollect tags="a,img"&gt;
 ...&lt;MTCollectThis&gt;...&lt;/MTCollectThis&gt;
 &lt;MTCollected tags="a"&gt;
 ...[this section will list anchor tags]
 &lt;/MTCollected&gt;
 &lt;MTCollected tags="img"&gt;
 ...[this section will list image tags]
 &lt;/MTCollected&gt;
&lt;/MTCollect&gt;
</pre>
<li><strong>group_by="content|site|attr_name" (optional)</strong><br>
Passing this attribute tells <a href="#MTCollected"><code>MTCollected</code></a> to create a grouped listing and display its contents once for each group. The possible types of grouping are:
<ul>
<li><code>content</code>: All tag instances whose content (the text between the opening and closing tags) is identical will be grouped together.
<li><code>site</code>: All tag instances that refer to the same site will be grouped together. The site is taken from whichever tag attribute(s) you indicated with the <code>urls</code> value passed to <a href="#MTCollect"><code>MTCollect</code></a>. Basically, the site for each URL is considered to be the machine name, but <code>www.</code> at the beginning is ignored, so links to <code>http://www.mysite.com</code> and <code>http://mysite.com</code> will be grouped together.
<li><code>attr_name</code>: If you pass the name of a tag attribute, all tag instances where that attribute is the same will be grouped together. This won't be very useful in most cases (it doesn't make much sense to group by <code>href</code> or <code>src</code>, for example), but it's there if you need it.
</ul>
<li><strong>sort_by="count|group|content|site|attr_name" (optional)</strong><br>
This tells <a href="#MTCollected"><code>MTCollected</code></a> how you want the listing sorted. For grouped listings, the possible sort orders are:
<ul>
<li><code>count</code>: The listing will be sorted numerically according to the number of tag instances belonging to each group.
<li><code>group</code>: The listing will be sorted alphabetically according to the name of each group&#151;which will be either tag content, site, or an attribute, depending on what <code>group_by</code> value you're using. This is the default sort order if you don't pass <code>sort_by</code>.
</ul>
<p>For non-grouped listings, if you don't specify <code>sort_by</code>, the tag instances will simply be listed in the order in which they originally appeared in the text from which they were collected. The other possible sort orders are:
<ul>
<li><code>content</code>: The listing will be sorted alphabetically according to the content of each tag instance.
<li><code>site</code>: The listing will be sorted alphabetically according to the site corresponding to each tag instance, which is determined as described above.
<li><code>attr_name</code>: Pass the name of a tag attribute to sort the listing alphabetically according to the value of that attribute for each tag instance.
</ul>
<li><strong>sort_order="ascend|descend" (optional)</strong><br>
The order in which the listing should be sorted. The default is an ascending sort.
<li><strong>skip_dupes="1" (optional)</strong><br>
In a sorted non-grouped listing, pass this to omit any tag instance whose sort key (attribute, content, or site) is the same as the one above it in the listing.
<li><strong>show_local="1" (optional)</strong><br>
This applies to non-grouped listings and listings grouped by <code>site</code>. By default, <a href="#MTCollected"><code>MTCollected</code></a> will skip items with a blank site value&#151;in other words, relative links to pages or images on your own site. Pass this attribute if you want the listing to include items with no site. (Note that if you <b>do</b> want to skip local links, you must pass a <code>urls</code> value to <a href="#MTCollect"><code>MTCollect</code></a> so the plugin knows which attribute contains the site.)
<li><strong>lastn="N" (optional)</strong><br>
If you pass this attribute, <a href="#MTCollected"><code>MTCollected</code></a> will restrict the listing to the top <code>N</code> items&#151;either groupings or tag instances&#151;that would appear in the sorted list.
<li><strong>min_count="N" (optional)</strong><br>
Applies to grouped listings only. If you pass this attribute, <a href="#MTCollected"><code>MTCollected</code></a> will only display groupings that contain <code>N</code> or more tag instances.
</ul>
<p>
<h2><a name="MTCollectedEntryTags"></a>MTCollectedEntryTags</h2></p>
<p>This container tag must be called from within an <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#item_MTEntries"><code>MTEntries</code></a> tag. That <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#item_MTEntries"><code>MTEntries</code></a> tag, in turn, must either be within a grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or in a template that's loaded by <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a>.</p>
<p>For a given entry, <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a> loops through all the tag instances collected from that entry that belong to the current grouping. Within <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a>, use <a href="#MTCollectedTag"><code>MTCollectedTag</code></a>, <a href="#MTCollectedSite"><code>MTCollectedSite</code></a>, <a href="#MTCollectedContent"><code>MTCollectedContent</code></a>, and <a href="#MTCollectedAttr"><code>MTCollectedAttr</code></a> to display the respective pieces of each tag instance.</p>
<p>The tag takes the following attribute:</p>
<ul>
<li><strong>tags="tag1,tag2.." (optional)</strong><br>
The names of one or more HTML tags whose instances you want to loop through. Multiple tags should be separated by commas. If you don't pass <code>tags</code>, <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a> will loop through all the tags you originally told <a href="#MTCollect"><code>MTCollect</code></a> to collect.</li></ul>
<p>
<h2><a name="MTCollectedTag"></a>MTCollectedTag</h2></p>
<p>Within a non-grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or within <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a>, displays the name (such as <code>a</code> or <code>img</code>) of the current tag instance.</p>
<p>
<h2><a name="MTCollectedContent"></a>MTCollectedContent</h2></p>
<p>Within a non-grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or within <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a>, displays the content (the text between the opening and closing tags) of the current tag instance.</p>
<p>
<h2><a name="MTCollectedSite"></a>MTCollectedSite</h2></p>
<p>Within a non-grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or within <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a>, displays the site of the current tag instance. (You must have passed the <code>urls</code> attribute to <a href="#MTCollect"><code>MTCollect</code></a> in order for the site information to have been collected.)</p>
<p>
<h2><a name="MTCollectedAttr"></a>MTCollectedAttr</h2></p>
<p>Within a non-grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or within <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a>, displays a particular attribute (such as <code>href</code> or <code>src</code>) of the current tag instance.</p>
<p>The tag takes the following attribute:</p>
<ul>
<li><strong>attr="attr_name" (required)</strong><br>
The name of the tag attribute to display.
</ul>
<p>
<h2><a name="MTIfCollectedContent"></a>MTIfCollectedContent</h2></p>
<p>Within a non-grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or within <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a>, this container tag displays its contents if and only if the current tag instance has some text between its opening and closing tags.</p>
<p>
<h2><a name="MTIfCollectedSite"></a>MTIfCollectedSite</h2></p>
<p>Within a non-grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or within <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a>, this container tag displays its contents if and only if the current tag instance has a site. (You must have passed the <code>urls</code> attribute to <a href="#MTCollect"><code>MTCollect</code></a> in order for the site information to have been collected.)</p>
<p>
<h2><a name="MTIfCollectedAttr"></a>MTifCollectedAttr</h2></p>
<p>Within a non-grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or within <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a>, this container tag displays its contents if and only if the current tag instance has a non-blank value in the specified attribute.</p>
<p>The tag takes the following attribute:</p>
<ul>
<li><strong>attr="attr_name" (required)</strong><br>
The name of the tag attribute to look for.
</ul>
<p>
<h2><a name="MTCollectedGroup"></a>MTCollectedGroup</h2></p>
<p>Within a grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or in a template that's loaded by <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a>, displays the name of the current grouping (content, site, or attribute).</p>
<p>
<h2><a name="MTCollectedTotalCount"></a>MTCollectedTotalCount</h2></p>
<p>Displays the total number of tag instances collected.</p>
<p>The tag takes the following attribute:</p>
<ul>
<li><strong>tags="tag1,tag2.." (optional)</strong><br>
The names of one or more HTML tags whose instances you want to count. Multiple tags should be separated by commas. If you pass multiple tags, the count will be the total number of collected instances of all specified tags. If you don't pass <code>tags</code>, the count will be the total number of instances of all tags.</li></ul>
<p>
<h2><a name="MTCollectedGroupCount"></a>MTCollectedGroupCount</h2></p>
<p>Within a grouped <a href="#MTCollected"><code>MTCollected</code></a> listing or in a template that's loaded by <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a>, displays the number of tag instances belonging to the current grouping.</p>
<p>The tag takes the following attribute:</p>
<ul>
<li><strong>tags="tag1,tag2.." (optional)</strong><br>
The names of one or more HTML tags whose instances you want to count. Multiple tags should be separated by commas. If you pass multiple tags, the count will be the total number of collected instances of all specified tags within this grouping. If you don't pass <code>tags</code>, the count will be the total number of instances of all tags within this grouping.</li></ul>
<p>
<h2><a name="MTCollectedIndex"></a>MTCollectedIndex</h2></p>
<p>Within an <a href="#MTCollected"><code>MTCollected</code></a> listing, either grouped or non-grouped, displays the loop index.</p>
<p>
<h2><a name="MTCollectedArchive"></a>MTCollectedArchive</h2></p>
<p>This container tag must be used within a grouped <a href="#MTCollected"><code>MTCollected</code></a> listing. Its purpose is to create an archive page on your site that corresponds to each grouping. Please understand this: <strong>Using this tag causes pages to be created on your site.</strong> That's not necessarily a bad thing, but it is an unusual thing for a plugin tag to do, so you should be sure you know what you're doing before using this tag. It's probably a good idea to build your template first <B>without</B> the <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> tag, and view the results, so you can see what files and/or directories will be created.</p>
<p>The tag is meant to be used on an index template. Since archive templates are built multiple times on each rebuild, it probably wouldn't be wise in most cases to use <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> on an archive template.</p>
<p><a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> displays its contents, stripped of any leading or trailing whitespace; and it also uses its contents as the filename of a file, and creates that file on your server. The file is created by building the MT template you specify in the <code>template</code> attribute. The idea is to use the <a href="#MTCollectedGroup"><code>MTCollectedGroup</code></a> tag within <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a>, so that a file is created with a name corresponding to each grouping.</p>
<p>The file is created in a location relative to your Local Archive Path for this weblog. You can also include a partial path before the filename to indicate that the files created should be placed in a particular directory within your Local Archive Path.</p>
<p>Let's say you have an <a href="#MTCollected"><code>MTCollected</code></a> listing, grouped by site, that produces four groupings:
<pre>apple.com
mt.sixapart.com
nytimes.com
search.cpan.org
</pre>
<p>You want to create an archive page that lists citations from each of these sites, within the directory <code>cite_archive</code>. Let's assume your Local Archive Path is <code>/www/mydomain/mtsite/</code>. You might use the following code within <a href="#MTCollected"><code>MTCollected</code></a>:
<pre>&lt;p&gt;&lt;a href="/mtsite/&lt;MTCollectedArchive template="collection"&gt;
cite_archive/&lt;$MTCollectedGroup dirify="1"&gt;.html
&lt;/MTCollectedArchive&gt;"&gt;&lt;$MTCollectedGroup$&gt;&lt;/a&gt;
</pre>
<p>Note that at the same time as you're using <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> to create the file, you're also using standard HTML to display a link to the file that will be created. Since <code>mtsite/</code> is already part of the Local Archive Path, it's placed <strong>within</strong> the link URL but <strong>outside</strong> the <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> tag. Also note that it's OK that the code above is broken up onto three lines, because <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> ignores leading and trailing whitespace. Finally, note the use of the <code>dirify</code> global attribute, which will turn the group name into an allowable filename. But <code>dirify</code> isn't used on the second instance of <a href="#MTCollectedGroup"><code>MTCollectedGroup</code></a>, because that's just the link text you're displaying to the user.</p>
<p>So, what exactly will happen here? The code above will produce the following output on this index page:</p>
<pre>&lt;p&gt;&lt;a href="/mtsite/cite_archive/applecom.html"&gt;apple.com&lt;/a&gt;
&lt;p&gt;&lt;a href="/mtsite/cite_archive/mtsixapartcom.html"&gt;mt.sixapart.com&lt;/a&gt;
&lt;p&gt;&lt;a href="/mtsite/cite_archive/nytimescom.html"&gt;nytimes.com&lt;/a&gt;
&lt;p&gt;&lt;a href="/mtsite/cite_archive/searchcpanorg.html"&gt;search.cpan.org&lt;/a&gt;
</pre>
<p>And the following files will be created on your server:</p>
<pre>/www/mydomain/mtsite/cite_archive/applecom.html
/www/mydomain/mtsite/cite_archive/mtsixapartcom.html
/www/mydomain/mtsite/cite_archive/nytimescom.html
/www/mydomain/mtsite/cite_archive/searchcpanorg.html
</pre>
<p>As for what those pages might actually contain, please see the full <a href="#UsageExamples">Usage Examples</a> below.
<p>The tag takes the following attributes:</p>
<ul>
<li><strong>template="template_name" (required)</strong><br>
The name of a Movable Type template. You should create this as either a Template Module or an Index Template that's set <strong>not</strong> to "Rebuild automatically when rebuilding index templates." <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> will load this template and build it once for each grouping.</li>
<li><strong>create_directories="1" (optional)</strong><br>
By default, <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> will not create directories that do not already exist in the path to the files it creates. Pass <code>create_directories="1"</code> if you want any missing directories to be automatically created. This is basically a "Yes, I know what I'm doing" attribute&#151;a precaution so that you don't accidentally create 
dozens of unwanted directories on your server.</li>
<li><strong>omit_filename="1" (optional)</strong><br>
If you're using the group name as a directory name, you might not want to include the actual filename in the link you generate. For instance, you might want to link to <code>/mydomain/mtsite/applecom/</code> instead of <code>/mydomain/mtsite/applecom/index.html</code>. If you pass <code>omit_filename="1"</code>, <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> will still use the filename to create the file, but will display only the path portion of its contents (including a trailing slash) on the template.</li>
</ul>

<p>
<h2><a name="UsageExamples"></a>Usage Examples</h2></p>
<ul>
<li><strong>Listing the Links in Each Entry</strong>
<p>Objective: Below each entry, display all the links contained in the entry.
<pre>
&lt;MTEntries&gt;
 &lt;MTCollect tags="a"&gt;
  &lt;p&gt;&lt;$MTEntryTitle$&gt;&lt;br&gt;
  &lt;MTCollectThis show="1"&gt;
   &lt;$MTEntryBody$&gt;
  &lt;/MTCollectThis&gt;
  &lt;MTIfCollected tags="a"&gt;
   &lt;p&gt;Links in this entry:
    &lt;MTCollected tags="a" sort_by="content"&gt;
    &lt;br&gt;&lt;a href="&lt;$MTCollectedAttr attr="href"$&gt;"&gt;&lt;$MTCollectedContent$&gt;&lt;/a&gt;
   &lt;/MTCollected&gt;
  &lt;/MTIfCollected&gt;
 &lt;/MTCollect&gt;
&lt;/MTEntries&gt;
</pre>

<li><strong>Footnoting Links</strong>
<p>Objective: Below each entry, display a numbered list of the URLs linked to in the entry, and insert the corresponding footnote numbers, in the format <code>[1]</code>, <code>[2]</code>, <code>[3]</code>... into the entry body.
<pre>
&lt;MTEntries&gt;
 &lt;MTCollect tags="a"&gt;
  &lt;p&gt;&lt;$MTEntryTitle$&gt;&lt;br&gt;
  &lt;MTCollectThis show="1" a="/\[[N]\]"&gt;
   &lt;$MTEntryBody$&gt;
  &lt;/MTCollectThis&gt;
  &lt;MTIfCollected tags="a"&gt;
   &lt;p&gt;Notes:
   &lt;MTCollected tags="a"&gt;
    &lt;br&gt;&lt;$MTCollectedIndex$&gt;) &lt;$MTCollectedAttr attr="href"$&gt;
   &lt;/MTCollected&gt;
  &lt;/MTIfCollected&gt;
 &lt;/MTCollect&gt;
&lt;/MTEntries&gt;
</pre>

<li><strong>Stripping HTML For Plain-Text Presentation</strong>
<p>Objective: Display an entry stripped of all HTML tags, replacing certain tags with appropriate non-HTML formatting. This example wraps italicized text in asterisks (so <code>I &lt;i&gt;love&lt;/i&gt; plugins</code> becomes <code>I *love* plugins</code>), changes each &lt;hr&gt; to a line of dashes, and replaces each image with a string containing the image's path or URL.
<pre>
&lt;MTEntries&gt;
 &lt;MTCollect tags="img,i,hr"&gt;
  &lt;MTCollectThis show="1" remove_html="1" img="\[IMAGE: [src]\]" i="*/*" hr="-------------"&gt;
   &lt;$MTEntryBody$&gt;
  &lt;/MTCollectThis&gt;
 &lt;/MTCollect&gt;
&lt;/MTEntries&gt;
</pre>
<p>Note that the actual stripping of HTML is done by MT's built-in <a href="http://www.sixapart.com/movabletype/docs/mtmanual_tags.html#global%20tag%20attributes"><code>remove_html</code></a> global attribute, not by the Collect plugin itself.

<li><strong>Listing Recent Links</strong>
<p>Objective: On a sidebar or elsewhere in your navigation, display the URLs you've most recently linked to in your entries.
<pre>
&lt;MTCollect tags="a"&gt;
 &lt;MTEntries lastn="20"&gt;
  &lt;MTCollectThis&gt;
  &lt;$MTEntryBody$&gt;
  &lt;/MTCollectThis&gt;
 &lt;/MTEntries&gt;
 Recent Links:&lt;br&gt;
 &lt;MTCollected tags="a" lastn="10" show_local="1"&gt;
  &lt;a href="&lt;$MTCollectedAttr attr="href"$&gt;"&gt;&lt;$MTCollectedAttr attr="href"$&gt;&lt;/a&gt;&lt;br&gt;
 &lt;/MTCollected&gt;
&lt;/MTCollect&gt;
</pre>
<p>The example above uses the URL as the text of the link. If that's too long for the location where you want to put it, you could use the linked site as the text:
<pre>
&lt;MTCollect tags="a" urls="href"&gt;
 &lt;MTEntries lastn="20"&gt;
  &lt;MTCollectThis&gt;
   &lt;$MTEntryBody$&gt;
  &lt;/MTCollectThis&gt;
 &lt;/MTEntries&gt;
 Recent Links:&lt;br&gt;
 &lt;MTCollected tags="a" lastn="10"&gt;
  &lt;a href="&lt;$MTCollectedAttr attr="href"$&gt;"&gt;&lt;$MTCollectedSite$&gt;&lt;/a&gt;&lt;br&gt;
 &lt;/MTCollected&gt;
&lt;/MTCollect&gt;
</pre>
<p>Note the inclusion of <code>urls="href"</code> in the <a href="#MTCollect"><code>MTCollect</code></a> tag, which is necessary to get the plugin to collect the site information.

<li><strong>Creating a Glossary of Acronyms</strong>
<p>Objective: Create a glossary listing the definitions of the acronyms that appear in your entries.
<p>HTML's <code>acronym</code> tag is intended for marking up acronyms with their definitions, like so:
<pre>&lt;acronym title="World Wide Web"&gt;WWW&lt;/acronym&gt;</pre>
<p>If the acronyms in your entries are tagged like this, you can create a glossary with the following code:
<pre>
&lt;MTCollect tags="acronym"&gt;
 &lt;MTEntries lastn="999"&gt;
  &lt;MTCollectThis&gt;
   &lt;$MTEntryBody$&gt;
  &lt;/MTCollectThis&gt;
 &lt;/MTEntries&gt;
 &lt;MTCollected tags="acronym" sort_by="content" skip_dupes="1"&gt;
  &lt;$MTCollectedContent$&gt;: &lt;$MTCollectedAttr attr="title"$&gt;&lt;br&gt;
 &lt;/MTCollected&gt;
&lt;/MTCollect&gt;
</pre>
<p>Note the use of the <code>skip_dupes</code> attribute to omit duplicate acronyms from the listing.

<li><strong>Archiving Entries by Linked Site</strong>
<p>Objective: Create a set of archive pages, each of which lists all the entries that link to pages on a particular site.</p>
<p>This code goes on the index template:
<pre>
&lt;MTCollect tags="a" urls="href"&gt;
 &lt;MTEntries lastn="999"&gt;&gt;
  &lt;MTCollectThis&gt;
   &lt;$MTEntryBody$&gt;
  &lt;/MTCollectThis&gt;
 &lt;/MTEntries&gt;
 &lt;MTCollected tags="a" group_by="site" sort_by="count" sort_order="descend" min_count="5"&gt;
  &lt;a href="/mttest/&lt;MTCollectedArchive template="archive_links"&gt;
  links_archive/&lt;$MTCollectedGroup dirify="1"&gt;.html
  &lt;/MTCollectedArchive&gt;"&gt;&lt;$MTCollectedGroup$&gt;&lt;/a&gt; (&lt;$MTCollectedGroupCount$&gt;)&lt;br&gt;
 &lt;/MTCollected&gt;
&lt;/MTCollect&gt;
</pre>
<p>And this code goes into a template module named <code>archive_links</code>:
<pre>
&lt;p&gt;Entries linking to &lt;$MTCollectedGroup$&gt;&lt;br&gt;
(&lt;$MTCollectedGroupCount$&gt; entries)
&lt;MTEntries&gt;
&lt;p&gt;&lt;a href="&lt;$MTEntryPermalink$&gt;"&gt;&lt;$MTEntryTitle$&gt;&lt;/a&gt; (&lt;$MTEntryDate format="%m/%d/%Y"$&gt;)
&lt;/MTEntries&gt;
</pre>
<p>The code above will create an archive page for any site you've linked to at least 5 times (because of the <code>min_count="5"</code> attribute). It will create pages in the directory <code>links_archive</code> within your local archive path. Each archive page will display the titles of the entries linking to a particular site, with a link to each entry.
<p>What if, beneath each entry shown on the archive page, you want to list the actual links to the site in question? That's where <a href="#MTCollectedEntryTags"><code>MTCollectedEntryTags</code></a> comes in. You could use the following code in the template module:
<pre>
&lt;p&gt;Entries linking to &lt;$MTCollectedGroup$&gt;&lt;br&gt;
(&lt;$MTCollectedGroupCount$&gt; entries)
&lt;MTEntries&gt;
&lt;p&gt;&lt;a href="&lt;$MTEntryPermalink$&gt;"&gt;&lt;$MTEntryTitle$&gt;&lt;/a&gt; (&lt;$MTEntryDate format="%m/%d/%Y"$&gt;)
&lt;ul&gt;
&lt;MTCollectedEntryTags tags="a"&gt;
&lt;li&gt;&lt;a href="&lt;$MTCollectedAttr attr="href"$&gt;"&gt;&lt;$MTCollectedContent$&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/MTCollectedEntryTags&gt;
&lt;/ul&gt;
&lt;/MTEntries&gt;
</pre>

<li><strong>Archiving Entries by Cited Source</strong>
<p>Objective: Create a set of archive pages, each of which lists all the entries that cite a particular source, as you've specified with the <code>cite</code> tag.
<p>HTML's <code>cite</code> tag can be used to mark up the names of various sources you're citing in your text, as follows:
<pre>
&lt;cite&gt;Malcolm Lowry&lt;/cite&gt;: &lt;a href="http://somewhere.com/page.html"&gt;I am somewhat thirsty&lt;/a&gt;. Interesting.

Perhaps &lt;cite&gt;Wired Magazine&lt;/cite&gt; put it best when they said, "Hey, computers are good."
</pre>
If your entries are consistently marked up in this fashion, you can use the following code to generate archives of entries by cited source. This goes on the index template:
<pre>
&lt;MTCollect tags="cite"&gt;
 &lt;MTEntries lastn="999"&gt;&gt;
  &lt;MTCollectThis&gt;
   &lt;$MTEntryBody$&gt;
  &lt;/MTCollectThis&gt;
 &lt;/MTEntries&gt;
 &lt;MTCollected tags="cite" group_by="content" sort_by="group"&gt;
  &lt;a href="/mtsite/&lt;MTCollectedArchive template="archive_cite"&gt;
  cite_archive/&lt;$MTCollectedGroup dirify="1"&gt;.html
  &lt;/MTCollectedArchive&gt;"&gt;&lt;$MTCollectedGroup$&gt;&lt;/a&gt; (&lt;$MTCollectedGroupCount$&gt;)&lt;br&gt;
 &lt;/MTCollected&gt;
&lt;/MTCollect&gt;
</pre>
<p>And this goes into a template module named <code>archive_cite</code>:
<pre>
&lt;p&gt;Entries that cite &lt;$MTCollectedGroup$&gt;&lt;br&gt;
(&lt;$MTCollectedGroupCount$&gt; entries)
&lt;MTEntries&gt;
&lt;p&gt;&lt;a href="&lt;$MTEntryPermalink$&gt;"&gt;&lt;$MTEntryTitle$&gt;&lt;/a&gt; (&lt;$MTEntryDate format="%m/%d/%Y"$&gt;)
&lt;/MTEntries&gt;
</pre>
<p>This will create pages in the directory <code>cite_archive</code> within your local archive path. With the example text above, the pages would be <code>malcolm_lowry.html</code> and <code>wired_magazine.html</code>. Each archive page will display the titles of the entries citing a particular source, with a link to each entry.

<li><strong>Archiving Quotations by Source</strong>
<p>Objective: Create a set of archive pages, each of which displays all <code>blockquote</code>d quotations from a particular source, and links to the entry containing each quotation.
<p>The <code>blockquote</code> HTML tag takes a <code>cite</code> attribute that can be used to specify the URL from which the quotation is taken. If you're using this attribute in your entries, you can use the following code to generate quotation archives. This goes on the index template:
<pre>
&lt;MTCollect tags="blockquote" urls="cite"&gt;
 &lt;MTEntries lastn="999"&gt;&gt;
  &lt;MTCollectThis&gt;
   &lt;$MTEntryBody$&gt;
  &lt;/MTCollectThis&gt;
 &lt;/MTEntries&gt;
 &lt;MTCollected tags="blockquote" group_by="site" sort_by="group"&gt;
  &lt;a href="/mtsite/&lt;MTCollectedArchive template="archive_quote"&gt;
  quote_archive/&lt;$MTCollectedGroup dirify="1"&gt;.html
  &lt;/MTCollectedArchive&gt;"&gt;&lt;$MTCollectedGroup$&gt;&lt;/a&gt; (&lt;$MTCollectedGroupCount$&gt;)&lt;br&gt;
 &lt;/MTCollected&gt;
&lt;/MTCollect&gt;
</pre>
And this goes into a template module named <code>archive_quote</code>:
<pre>
&lt;p&gt;Quotations from &lt;$MTCollectedGroup$&gt;&lt;br&gt;
&lt;MTEntries&gt;
&lt;p&gt;&lt;a href="&lt;$MTEntryPermalink$&gt;"&gt;&lt;$MTEntryTitle$&gt;&lt;/a&gt; (&lt;$MTEntryDate format="%m/%d/%Y"$&gt;)
&lt;MTCollectedEntryTags tags="blockquote"&gt;
&lt;blockquote cite="&lt;$MTCollectedAttr attr="cite"&gt;"&gt;&lt;$MTCollectedContent$&gt;
&lt;div align="right"&gt;&lt;a href="&lt;$MTCollectedAttr attr="cite"$&gt;"&gt;Quoted Page&lt;/a&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;/MTCollectedEntryTags&gt;
&lt;/MTEntries&gt;
</pre>
</ul>

<p>
<h2><a name="VersionHistory"></a>Version History</h2></p>

<p>7/12/04 - version 1.2<br>
<ul>
<li>Plugin now registers itself with MT 3 interface.</li>
<li>Added $VERSION variable.</li>
<li>Conditional container tags are now declared as conditional tags, so they should work with MTElse.</li>
</ul>
</p>

<p>3/1/04 - version 1.18<br>
<ul>
<li>All container tags now pass conditions along when building contents, so they'll work outside conditional tags within MTEntries, etc. (Floozle)</li>
</ul>
</p>

<p>7/22/03 - version 1.17<br>
<ul>
<li><a href="#MTIfCollected"><code>MTIfCollected</code></a> now checks for locality of URLs and takes <code>show_local</code> attribute. (Jason Mevius)</li>
<li>Fixed warning when <a href="#MTCollectThis"><code>MTCollectThis</code></a> encounters an undefined URL value. (Jason Mevius)</li>
</ul>
</p>

<p>7/10/03 - version 1.16<br>
<ul>
<li>Added <code>omit_filename</code> attribute to <a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a>. (Joshua Kaufman)</li>
</ul>
</p>

<p>7/10/03 - version 1.15<br>
<ul>
<li><a href="#MTCollectedArchive"><code>MTCollectedArchive</code></a> will now create any directories that don't exist in the path to a file it's trying to create, but only if you use the new <code>create_directories</code> attribute. (Joshua Kaufman)</li>
</ul>
</p>

<p>4/4/03 - version 1.1<br>
<ul>
<li>Added tags: <a href="#MTIfCollectedAttr"><code>MTIfCollectedAttr</code></a>, <a href="#MTIfCollectedContent"><code>MTIfCollectedContent</code></a>, <a href="#MTIfCollectedSite"><code>MTIfCollectedSite</code></a></li>
<li>Added <code>skip_dupes</code> attribute to <a href="#MTCollected"><code>MTCollected</code></a> (jrimmer)</li>
<li>Site names are now lowercased when collected</li>
<li>Fixed warning when a listing grouped by site encountered a tag with no site</li>
</ul>
</p>

<p>3/31/03 - version 1.01<br>
<ul>
<li>Local links are now skipped correctly in non-grouped <a href="#MTCollected"><code>MTCollected</code></a> listings (Tarun Nagpal)</li>
</ul>
</p>

<p>3/27/03 - version 1.0 released</p>

