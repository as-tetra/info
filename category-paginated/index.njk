---
pagination:
  data: categoryPages
  size: 1
  alias: page
permalink: "{{ page.permalink }}"
layout: base.njk
title: "{{ page.categoryName }}"
---

{# カテゴリーアーカイブ - MTのMTPaginate相当 #}
<div class="main">
  {# ヘッダー #}
  <div class="archive-header">
    <h1>{{ page.categoryName }}</h1>
    <p class="category-info">
      {{ page.categoryCount }} entries
      {% if page.totalPages > 1 %}
      <span class="page-indicator">(Page {{ page.pageNumber + 1 }} of {{ page.totalPages }})</span>
      {% endif %}
    </p>
  </div>

  {# エントリーリスト (MTPaginateContent) #}
  <div class="archive-list">
    {% for entry in page.entries %}
    <div class="block1">
      <h2><a href="{{ entry.url | url }}">{{ entry.title }}</a></h2>
      {% if entry.date %}
      <p class="entry-date">{{ entry.date | dateFormat }}</p>
      {% endif %}
      {% if entry.categories and entry.categories.length > 0 %}
      <p class="entry-categories">
        {% for cat in entry.categories %}
        <span class="category">{{ cat }}</span>{% if not loop.last %}, {% endif %}
        {% endfor %}
      </p>
      {% endif %}
      {% if entry.summary %}
      <p class="entry-summary">{{ entry.summary }}</p>
      {% endif %}
    </div>
    <div class="line1"></div>
    {% endfor %}
  </div>

  {# ページネーション (MTPaginateIfMultiplePages) #}
  {% if page.totalPages > 1 %}
  <div class="block_page">
    <span class="pagenate">
      <p>
        {# 前ページリンク (MTPaginateIfPreviousPage) #}
        {% if not page.isFirstPage %}
          {% if page.pageNumber === 1 %}
            <a href="{{ ('/' + page.categorySlug + '/') | url }}">&laquo;</a>
          {% else %}
            <a href="{{ ('/' + page.categorySlug + '/page/' + page.pageNumber + '/') | url }}">&laquo;</a>
          {% endif %}
        {% endif %}

        {# ページ番号リンク (MTPaginateNavigator style="links" separator=" | ") #}
        {% for i in range(0, page.totalPages) %}
          {% if i == page.pageNumber %}
            {# 現在のページ #}
            &nbsp;{{ i + 1 }}&nbsp;
          {% else %}
            {# リンク #}
            {% if i == 0 %}
              | <a href="{{ ('/' + page.categorySlug + '/') | url }}">&nbsp;{{ i + 1 }}&nbsp;</a>
            {% else %}
              | <a href="{{ ('/' + page.categorySlug + '/page/' + (i + 1) + '/') | url }}">&nbsp;{{ i + 1 }}&nbsp;</a>
            {% endif %}
          {% endif %}
        {% endfor %}

        {# 次ページリンク (MTPaginateIfNextPage) #}
        {% if not page.isLastPage %}
          <a href="{{ ('/' + page.categorySlug + '/page/' + (page.pageNumber + 2) + '/') | url }}">&raquo;</a>
        {% endif %}
      </p>
    </span>
  </div>
  {% endif %}
</div>
